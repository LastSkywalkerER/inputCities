(()=>{"use strict";var t=document.getElementById("select-cities"),e=document.querySelector(".dropdown-lists__list--default"),n=document.querySelector(".dropdown-lists__list--select"),o=document.querySelector(".dropdown-lists__list--autocomplete"),s=document.querySelector(".close-button"),l=document.querySelector(".button"),i=document.querySelector("label"),c=document.querySelector(".input-cities"),d=".dropdown-lists__total-line",a=".dropdown-lists__line",r=document.createElement("div"),u=document.querySelector("modal"),y=c.clientWidth,p="",f=!!localStorage.getItem("local")&&JSON.parse(localStorage.getItem("local")),v="RU",h="",m=function(){r.remove(),c.style.display="block"},g=function(t,e){var n=document.createElement("div");n.classList.add("dropdown-lists__countryBlock"),n.innerHTML='\n    <div class="dropdown-lists__total-line">\n      <div class="dropdown-lists__country">'.concat(e.country,'</div>\n      <div class="dropdown-lists__count">').concat(e.count,"</div>\n    </div>\n    "),t.append(n)},b=function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=document.createElement("div");s.classList.add("dropdown-lists__line"),s.innerHTML='\n    <div class="dropdown-lists__city">\n      <strong>'.concat(o.slice(0,1).toUpperCase()+o.slice(1).toLowerCase(),"</strong>").concat(e.name.replace(n,""),'\n    </div>\n    <div class="dropdown-lists__count">').concat(e.count,"</div>\n    "),t.append(s)},N=function(){var t=e.childNodes[1];t.textContent="",f.forEach((function(e){g(t,e);for(var n=0;n<3;n++)b(t,e.cities[n])}))},k=function(t){var e=o.childNodes[1],n=new RegExp("^".concat(t),"gi");e.textContent="",f.forEach((function(o){o.cities.forEach((function(o){n.test(o.name)&&(l.href=o.link,b(e,o,n,t))}))})),e.textContent||b(e,{name:h,count:""})},_=function(){i.style.display="block",p="",e.style.display="none",n.style.display="none",o.style.display="none"},w=function(){l.setAttribute("disabled",""),l.href="#",t.value="",e.style.display="block",n.style.display="none",o.style.display="none"},E=function(c){l.setAttribute("disabled",""),l.href="#";var a,r,u=c.target.closest(d).childNodes[1].textContent.trim();t.value=u,a=u,(r=n.childNodes[1]).textContent="",f.forEach((function(t){t.country===a&&(g(r,t),t.cities.forEach((function(t){b(r,t)})))})),i.style.display="none",s.style.display="block",e.style.display="none",n.style.display="block",o.style.display="none"},L=function(){document.addEventListener("click",(function(r){if(r.target===t?(w(),p="default"):r.target.closest("."+e.classList[1])||r.target.closest("."+n.classList[1])||r.target.closest("."+o.classList[1])||r.target.closest("#"+t.id)||r.target.closest("."+l.classList[0])||_(),r.target.closest(d)&&function(t){var o=0;c.childNodes[9].style.overflowX="hidden",c.childNodes[9].childNodes[1].style.width="".concat(2*y,"px"),c.childNodes[9].childNodes[1].style.position="relative","default"===p?(o=0,requestAnimationFrame((function n(){E(t),e.style.display="block",o+=50,c.childNodes[9].childNodes[1].style.right="".concat(o,"px"),o<=y?requestAnimationFrame(n):(E(t),c.childNodes[9].childNodes[1].style.width="100%",c.childNodes[9].childNodes[1].style.position="static")})),p="select"):"select"===p&&(o=y,requestAnimationFrame((function t(){w(),n.style.display="block",o-=50,c.childNodes[9].childNodes[1].style.right="".concat(o,"px"),o>=0?requestAnimationFrame(t):(w(),c.childNodes[9].childNodes[1].style.width="100%",c.childNodes[9].childNodes[1].style.position="static")})),p="default")}(r),r.target.closest(a)){var u=r.target.closest(a).childNodes[1].textContent.trim();t.value=u,l.removeAttribute("disabled",""),k(t.value.trim()),_()}r.target.closest("."+l.classList[0])&&(t.value="",_()),t.value?(i.style.display="none",s.style.display="block"):(i.style.display="block",s.style.display="none"),r.target.closest("."+s.classList[0])&&(t.value="",_(),s.style.display="none")})),t.addEventListener("input",(function(){t.value?(k(t.value.trim()),p="autocomplete",e.style.display="none",n.style.display="none",o.style.display="block"):(w(),p="default"),t.value?(i.style.display="none",s.style.display="block"):(i.style.display="block",s.style.display="none")}))},S=function(){var t;f?(m(),_(),L(),N()):(t=function(t){t.map((function(t){return function(t,e){for(var n in t)for(var o=1;o<t.length-n;o++)if(+t[o-1].count<+t[o].count){var s=t[o-1];t[o-1]=t[o],t[o]=s}return t}(t.cities)}));var e="",n=1;switch(v){case"RU":e="Россия";break;case"EN":e="United Kingdom";break;case"DE":e="Deutschland"}f=[],t.forEach((function(t){t.country===e?f[0]=t:(f[n]=t,n++)})),localStorage.setItem("local",JSON.stringify(f)),m(),_(),L(),N()},fetch("./db_cities.json").then((function(t){return t.json()})).then((function(e){return t(e[v])})))},q=function(){var t="",e="";switch(v){case"RU":h="Ничего не найдено",t="Страна или город",e="Перейти";break;case"EN":h="Nothing found",t="Country or city",e="Go over";break;case"DE":h="Niets gevonden",t="Land of stad",e="Ga over"}i.textContent=t,l.textContent=e};!function(){r.classList.add("sk-circle-bounce");for(var t=1;t<13;t++)r.insertAdjacentHTML("beforeend","<div class='sk-child sk-circle-".concat(t,"'></div>"));c.style.display="none",c.insertAdjacentElement("afterend",r)}(),document.cookie?(u.style.display="none",v=document.cookie,S(),q()):u.addEventListener("input",(function(t){v=t.target.value,document.cookie=v,u.style.display="none",f=!1,S(),q()}))})();